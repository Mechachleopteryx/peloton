changelog: null
name: TestTFGPUMesosContainerizerJob
owningteam: team6
ldapgroups:
- money
- team6
- otto
description: "A test job using unified containerizer and gpu based on ATC image that has tf"
labels:
  labels:
  - key: testKey0
    value: testVal0
  - key: testKey1
    value: testVal1
  - key: testKey2
    value: testVal2
instancecount: 1
defaultconfig:
  resource:
    cpulimit: 0.5
    memlimitmb: 128.0
    disklimitmb: 1024.0
    gpulimit: 1
  healthcheck: null
  ports:
  - name: "dropbear"
    envname: "DROPBEAR_PORT"
  container:
    type: 2  # mesos
    mesos:
      image:
        type: 2 # docker
        docker:
          name: "docker-registry.pit-irn-1.uberatc.net/uatc/uberatc-laptop-cuda8-tf1.1.0:8141dfb5c119"
    volumes:
      - containerpath: /mnt/map_prod/yyz_map
        hostpath: /mnt/map_prod/yyz_map
        mode: 1
      - containerpath: /mnt/map_prod/las_map
        hostpath: /mnt/map_prod/las_map
        mode: 1
  command:
    shell: true
    #value: 'env && echo dropbear port: $DROPBEAR_PORT && /usr/sbin/dropbear -F -p $DROPBEAR_PORT -B && sleep 3000'
    value: 'env && nvidia-smi && nvcc -V && echo dropbear port: $DROPBEAR_PORT && python /tf_test.py && echo OK'
